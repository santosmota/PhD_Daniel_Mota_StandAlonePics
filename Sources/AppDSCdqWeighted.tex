%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DSC in the dq FRAME - Frequency adaptive - Discretization problems
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tikzstyle{block} = [draw, rectangle, fill=white, minimum height=1cm, minimum width=1cm, font=\footnotesize]
\tikzstyle{caixa} = [rectangle, draw, fill=white, text width=1cm, text centered, minimum height=1cm, font=\footnotesize ] %,text width=2cm minimum width=2.2cm
\tikzstyle{sum} = [draw, circle, font=\footnotesize]
\tikzstyle{junction} = [coordinate]
\tikzstyle{fonte} = [font=\footnotesize]
\begin{tikzpicture}[auto, >=latex']

\node at (0,0) [block] (HalfIn) {$\frac{1}{2}$};
\draw [->] (-1,0) to node[fonte, anchor=east, pos=0] () {$x(k)$} (HalfIn);

\node at (2,-1) [block] (znc) {$z^{-n_c}$};
\draw [->] (HalfIn) to (1,0) |- (znc);
\draw [->] (1,0) to (1,0.5) to node [fonte, anchor=west, pos=1.0] () {$\frac{x(k)}{2}$} (1.5, 0.5);
\fill (1,0) circle [radius=1pt];

\node at (0,-2) [block] (ceil) {ceil};
\draw [->] (-1,-2) to node[fonte, anchor=east, pos=0] () {$n(k)$} (ceil); %=\frac{T(k)}{4 T_s}
\draw [->] (ceil) -| node [fonte, anchor=south, pos=0.2] () {$n_c(k)$} (znc);
\fill (-0.75,-2) circle [radius=1pt];

\node at (1,-3) [sum] (sumgamma) {$\Sigma$}; 
\fill (1,-2) circle [radius=1pt];
\draw [->] (1,-2) to node[fonte, anchor=west, pos=0.9] () {$+$} (sumgamma);
\draw [->] (-0.75,-2) to (-0.75,-3) to node[fonte, anchor=south, pos=0.9] () {$-$} (sumgamma);
\draw [->] (sumgamma) to node[fonte, anchor=west, pos=1] () {$\gamma(k)$} ++(0.75,0);
\fill (-0.75,-3) circle [radius=1pt];

\node at (0,-5) [block] (floor) {floor};
\draw [->] (-0.75,-3) |- (floor);

\node at (2,-4) [block] (znf) {$z^{-n_f}$};
\draw [<-] (znf) to node[fonte, anchor=east, pos=1] () {$\frac{x(k)}{2}$} ++(-1,0);
\draw [->] (floor) -| node [fonte, anchor=south, pos=0.2] () {$n_f(k)$} (znf);

\node at (3,0) [sum] (sumceil) {$\Sigma$};
\draw [->] (HalfIn) to node[fonte, anchor=south, pos=0.9] () {$+$} (sumceil);
\draw [->] (znc) -| node[fonte, anchor=east, pos=0.8] () {$+$} (sumceil);

\node at (3,-3) [sum] (sumfloor) {$\Sigma$};
\draw [->] (znf) -| node[fonte, anchor=east, pos=0.8] () {$+$} (sumfloor);
\draw [<-] (sumfloor) to node[fonte, anchor=east, pos=0.4] () {$+$} node[fonte, anchor=south, pos=1.0] () {$\frac{x(k)}{2}$} ++(0,0.75);

\node at (5,0) [sum] (prodceil) {$\Pi$};
\draw [->] (sumceil) to node[fonte, anchor=south, pos=0.3] () {$y_c(k)$} node[fonte, anchor=south, pos=0.8] () {$+$} (prodceil);
\draw [<-] (prodceil) to node[fonte, anchor=east, pos=0.4] () {$+$} node[fonte, anchor=north, pos=1.0] () {$1-\gamma(k)$} ++(0,-1);

\node at (5,-3) [sum] (prodfloor) {$\Pi$};
\draw [->] (sumfloor) to node[fonte, anchor=south, pos=0.3] () {$y_f(k)$} node[fonte, anchor=south, pos=0.8] () {$+$} (prodfloor);
\draw [<-] (prodfloor) to node[fonte, anchor=east, pos=0.4] () {$+$} node[fonte, anchor=north, pos=1.0] () {$\gamma(k)$} ++(0,-1);

\node at (6,0) [sum] (sumout) {$\Sigma$};
\draw [->] (prodceil) to node[fonte, anchor=south, pos=0.8] () {$+$} (sumout);
\draw [->] (prodfloor) -| node[fonte, anchor=east, pos=0.95] () {$+$} (sumout);
\draw [->] (sumout) to node[fonte, anchor=west, pos=1] () {$y_w(k)$} ++(0.75,0);

\end{tikzpicture}
